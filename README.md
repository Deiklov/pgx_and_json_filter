# Nats and docker-compose
Тестирование работы nats и postgresql c job и cronjob

 		
 ### инфа по nats-streaming 
 1. нет request-reply
 2. ack это подвтерждение доставки сообщения, направлено к серверу, а не к паблишеру
 3. можно вручную прописывать ack  
 4. topic nats and nats streaming не пересекаются, те subcribe("appliciant") будут принимать разные сообщения  
 5. можно хранить состояние в файле  
 6. для работы натс и натс-стриминг достаточно запустить контейнер с натс-стримингом  
 
 
### Схема работы v2  
1. Джобы так же подпсываются через QueueSubscribe()
2. Если нет новых задач в течении 10 min, то джоба заврешается
(соответсвенно все его горутины тоже свернуться, поэтому 10 мин отсчитываем от взятие последнего таска)  
3. Добавляем stan.SetManualAckMode(), stan.AckWait(30*time.Second) для возврата в очередь плохо обработанных задач
4. через afterfunc делаем программный таймер на отключение, если сообщения не приходят более 10 минут  
5. после работы пишем результат в postgres 
